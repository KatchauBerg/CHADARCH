# windowrules.conf — adapted from HyDE
# Deployed by theme-switch.sh → ~/.config/hypr/windowrules.conf
# Sourced by hyprland.conf
#
# Syntax: current Hyprland inline + block format
#   windowrule = rule value, match:filter regex
#   windowrule { name = id; match:filter = regex; rule = value }
#   layerrule  = effect value, match:namespace name

# ===========================================================================
# GLOBAL SUPPRESSION
# ===========================================================================

windowrule = suppress_event maximize, match:class .*

# ===========================================================================
# IDLE INHIBIT
# ===========================================================================

windowrule = idle_inhibit fullscreen true, match:class ^(.*celluloid.*|.*mpv.*|.*vlc.*)$
windowrule = idle_inhibit fullscreen true, match:class ^(.*[Ss]potify.*)$
windowrule = idle_inhibit fullscreen true, match:class ^(.*firefox.*|.*chromium.*|.*brave-browser.*|.*LibreWolf.*|.*zen.*)$

# ===========================================================================
# PICTURE IN PICTURE
# ===========================================================================

windowrule {
    name = picture-in-picture
    match:title = ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
    float           = true
    keep_aspect_ratio = true
    pin             = true
    move            = (monitor_w*0.73) (monitor_h*0.72)
    size            = (monitor_w*0.25) (monitor_h*0.25)
}

# ===========================================================================
# OPACITY
# ===========================================================================

windowrule = opacity 0.90 0.88, match:class ^(firefox)$
windowrule = opacity 0.90 0.88, match:class ^(brave-browser)$
windowrule = opacity 0.80 0.80, match:class ^(code-oss|[Cc]ode|code-url-handler|code-insiders-url-handler)$
windowrule = opacity 0.80 0.80, match:class ^(kitty)$
windowrule = opacity 0.80 0.80, match:class ^(org\.kde\.dolphin|org\.kde\.ark)$
windowrule = opacity 0.80 0.70, match:class ^(org\.pulseaudio\.pavucontrol|pavucontrol)$
windowrule = opacity 0.80 0.70, match:class ^(blueman-manager)$
windowrule = opacity 0.80 0.70, match:class ^(nm-applet|nm-connection-editor)$
windowrule = opacity 0.80 0.70, match:class ^(org\.freedesktop\.impl\.portal\.desktop\..*)$
windowrule = opacity 0.70 0.70, match:class ^([Ss]team|steamwebhelper)$
windowrule = opacity 0.70 0.70, match:class ^([Ss]potify)$
windowrule = opacity 0.80 0.80, match:class ^(vesktop|discord|WebCord|ArmCord)$
windowrule = opacity 0.80 0.80, match:class ^(Signal)$
windowrule = opacity 0.80 0.80, match:class ^(com\.obsproject\.Studio)$
windowrule = opacity 0.80 0.80, match:class ^(gnome-boxes)$
windowrule = opacity 0.80 0.80, match:class ^(io\.missioncenter\.MissionCenter)$
windowrule = opacity 0.80 0.80, match:class ^(io\.github\.flattool\.Warehouse)$

# ===========================================================================
# FLOAT RULES
# ===========================================================================

windowrule = float true, match:class ^(Signal)$
windowrule = float true, match:class ^(eog|imv|sxiv|feh)$
windowrule = float true, match:class ^(gnome-calculator|qalculate-gtk)$
windowrule = float true, match:class ^(hyprpicker)$
windowrule = float true, match:class ^(xdg-desktop-portal)$
windowrule = float true, match:class ^(blueman-manager)$
windowrule = float true, match:class ^(nm-connection-editor)$
windowrule = float true, match:class ^(io\.missioncenter\.MissionCenter)$
windowrule = float true, match:title ^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Save File|Library)
windowrule = float true, match:title ^(Confirm|Are you sure)

windowrule {
    name = pavucontrol
    match:class = ^(org\.pulseaudio\.pavucontrol|pavucontrol)$
    float  = true
    center = true
    size   = 700 450
}

# JetBrains IDE popup flicker workaround
windowrule = no_initial_focus true, match:class ^(.*jetbrains.*)$, match:title ^(win[0-9]+)$

# ===========================================================================
# STEAM
# ===========================================================================

windowrule {
    name = steam-main
    match:class = ^([Ss]team)$
    match:title = ^(Steam)$
    workspace = 9 silent
}

windowrule {
    name = steam-popups
    match:class = ^([Ss]team)$
    match:title = ^(?!Steam$)
    float  = true
    center = true
}

windowrule = workspace 9, match:class ^(steam_app_.*)$

# ===========================================================================
# LAYER RULES
# ===========================================================================

layerrule = blur true,       match:namespace rofi
layerrule = ignore_alpha 0,  match:namespace rofi
layerrule = blur true,       match:namespace notifications
layerrule = ignore_alpha 0,  match:namespace notifications
layerrule = blur true,       match:namespace swaync-notification-window
layerrule = ignore_alpha 0,  match:namespace swaync-notification-window
layerrule = blur true,       match:namespace swaync-control-center
layerrule = ignore_alpha 0,  match:namespace swaync-control-center
layerrule = blur true,       match:namespace gtk-layer-shell
layerrule = ignore_alpha 0,  match:namespace gtk-layer-shell

# ===========================================================================
# COMPOSITOR / XWAYLAND
# ===========================================================================

windowrule {
    # Fix dragging issues with XWayland
    name            = fix-xwayland-drags
    match:class     = ^$
    match:title     = ^$
    match:xwayland  = true
    match:float     = true
    match:fullscreen = false
    match:pin       = false

    no_focus = true
}

windowrule {
    # hyprland-run popup: bottom-left corner
    name        = hyprland-run-popup
    match:class = hyprland-run

    move  = 20 monitor_h-120
    float = true
}
